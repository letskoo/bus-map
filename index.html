<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>버스 위치</title>

<script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=7760a4557ccbf1f9dd40e051124ba1fc&autoload=false"></script>

<style>
html, body{
margin:0;
padding:0;
height:100%;
}
#map{
width:100%;
height:100vh;
}
</style>
</head>

<body>

<div id="map"></div>

<script>
kakao.maps.load(function(){

const mapContainer = document.getElementById("map");

const mapOption = {
center: new kakao.maps.LatLng(36.3504,127.3845),
level:3
};

const map = new kakao.maps.Map(mapContainer, mapOption);

const marker = new kakao.maps.Marker({
position: mapOption.center
});
marker.setMap(map);

// ⭐ 서버 주소
const SERVER="https://bus-server-production.up.railway.app";

// ⭐ routeId (노선번호)
const ROUTE_ID=1;

// ⭐ 2초마다 서버에서 위치 가져오기
setInterval(async ()=>{

try{
const res = await fetch(`${SERVER}/driver/location/${ROUTE_ID}`);
const data = await res.json();

if(!data || !data.latitude) return;

const pos = new kakao.maps.LatLng(data.latitude,data.longitude);

marker.setPosition(pos);
map.setCenter(pos);

}catch(e){
console.log("서버연결대기중");
}

},2000);

});
</script>

</body>
</html>